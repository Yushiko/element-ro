//===== DivineRO Script ===========================================
//= Selector de WOE
//===== Por: ======================================================
//= Vladd
//===== Versión ===================================================
//= 1.5
//===== Compatible: ===============================================
//= Cualquier versión
//===== Descripción: ==============================================
//= - Los Users lo verán como un NPC normal. Los GM accederán a un 
//= menú en el prodrán elegir la ciudad donde se va a celebrar la
//= WOE.
//= - Muestra un anuncio de donde empieza la WOE.
//= - Añadida la configuración del horario de las WOE.
//=================================================================
prontera.gat,130,216,1	script	Vladd	849,{
set @name$,"[^0000FF WOE Selector ^000000]"; //Nombre del NPC
if(getgmlevel() == 99) goto MENUGM; //Si el jugador no es GM , lo verá como un NPC normal
mes @name$;
mes "Hola, ^0000A0 " + strcharinfo(0) + " ^000000.";
mes "Aqui en TUSERVIDOR tenemos Dias en Especiales de WOE!!";
mes "Recuerda que Este Sistema se hizo con el Fin de tener, ";
mes "Batallas inolvidables!!";
next;
mes @name$;
mes "Las Ciudades Donde hay WOE Son:";
mes "1 - Prontera";
mes "2 - Geffen";
mes "3 - Payon";
mes "4 - Aldebarán";
next;
mes @name$;
mes "Los Horarios de la WOE en TUSERVIDOR son:";
next;
if($sday[@num] == 0 && $eday[@num] == 0 && $woetime[@num] == 0 && $woetime2[@num] == 0) goto L_LoopListEnd;
if($sday[@num]==0) set $@tempday$,"Domingo";
if($sday[@num]==1) set $@tempday$,"Lunes";
if($sday[@num]==2) set $@tempday$,"Martes";
if($sday[@num]==3) set $@tempday$,"Miercoles";
if($sday[@num]==4) set $@tempday$,"Jueves";
if($sday[@num]==5) set $@tempday$,"Viernes";
if($sday[@num]==6) set $@tempday$,"Sabado";
if($eday[@num]==0) set $@tempday2$,"Domingo";
if($eday[@num]==1) set $@tempday2$,"Lunes";
if($eday[@num]==2) set $@tempday2$,"Martes";
if($eday[@num]==3) set $@tempday2$,"Miercoles";
if($eday[@num]==4) set $@tempday2$,"Jueves";
if($eday[@num]==5) set $@tempday2$,"Viernes";
if($eday[@num]==6) set $@tempday2$,"Sabado";
if($eday[@num]==$sday[@num]) mes $@tempday$+" de "+$woetime[@num]+":00 hasta "+$woetime2[@num]+":00";
if($eday[@num]!=$sday[@num]) mes "De "+$@tempday$+" "+$woetime[@num]+":00 hasta "+$@tempday2$+" "+$woetime2[@num]+":00";
mes "En la Ciudad de "+$ciudad+"";
close;

MENUGM: //Este menú es solo para los GM's
mes "[Menú GM]";
mes "¿Qué deseas configurar?";
menu "Castillos",Castillos,"Horario WOE",Horario;

Castillos: // Configuración de los Ciudades
mes "[Configurador Castillos]";
mes "Por favor elige el grupo";
mes "El grupo actual es "+$ciudad+"";
set $ciudad, select (
"- Prontera", //1
"- Geffen", //2
"- Payon", //3
"- Aldebarán" //4
);
mes "El Nuevo Grupo es "+$ciudad+"";
mes "Gracias";
close;

Horario: // Configuración del Horario de las WOE

mes "[Configurador Horario]";
mes "Qué deseas modificar?";
next;
menu "Modificar el Horario",L_Add,"Resetear el Horario",L_Reset,"Ver el Horario actual",-;
mes "[Configurador Horario]";
mes "Ok currently you have WoE times set for:-";
set @num,0;
L_LoopList:
if($sday[@num] == 0 && $eday[@num] == 0 && $woetime[@num] == 0 && $woetime2[@num] == 0) goto L_LoopListEnd;
if($sday[@num]==0) set $@tempday$,"Domingo";
if($sday[@num]==1) set $@tempday$,"Lunes";
if($sday[@num]==2) set $@tempday$,"Martes";
if($sday[@num]==3) set $@tempday$,"Miercoles";
if($sday[@num]==4) set $@tempday$,"Jueves";
if($sday[@num]==5) set $@tempday$,"Viernes";
if($sday[@num]==6) set $@tempday$,"Sábado";
if($eday[@num]==0) set $@tempday2$,"Domingo";
if($eday[@num]==1) set $@tempday2$,"Lunes";
if($eday[@num]==2) set $@tempday2$,"Martes";
if($eday[@num]==3) set $@tempday2$,"Miercoles";
if($eday[@num]==4) set $@tempday2$,"Jueves";
if($eday[@num]==5) set $@tempday2$,"Viernes";
if($eday[@num]==6) set $@tempday2$,"Sábado";
if($eday[@num]==$sday[@num]) mes $@tempday$+" de "+$woetime[@num]+":00 hasta "+$woetime2[@num]+":00";
if($eday[@num]!=$sday[@num]) mes "De "+$@tempday$+" "+$woetime[@num]+":00 hasta "+$@tempday2$+" "+$woetime2[@num]+":00";
mes "En la Ciudad de "+$ciudad+"";
set @num,@num+1;
goto L_LoopList;
L_LoopListEnd:
close;
L_Add:
set @num,0;
L_AddLoop:
if($sday[@num] == 0 && $eday[@num] == 0 && $woetime[@num] == 0 && $woetime2[@num] == 0) goto L_AddLoopEnd;
set @num,@num+1;
goto L_AddLoop;
L_AddLoopEnd:
mes "[Configurador Horario]";
mes "Qué día quieres que empiece la WOE?";
next;
menu "Domingo",-,"Lunes",-,"Martes",-,"Miercoles",-,"Jueves",-,"Viernes",-,"Sábado",-;
if(@menu==1) set $sday[@num],0;
if(@menu==2) set $sday[@num],1;
if(@menu==3) set $sday[@num],2;
if(@menu==4) set $sday[@num],3;
if(@menu==5) set $sday[@num],4;
if(@menu==6) set $sday[@num],5;
if(@menu==7) set $sday[@num],6;
mes "[Configurador Horario]";
mes "Vale, ahora debes introducir la hora a la que quieres que empiece la WOE";
mes "Se usa el formato de 24 Horas";
mes "00 = Media-Noche";
mes "12 = Medio-Día";
mes "23 = 11 p.m.";
next;
input @input;
if (@input < 0 || @input > 24) goto L_BadNumber;
set $woetime[@num],@input;
mes "[Configurador Horario]";
mes "Qué día quieres que acabe la WOE?";
next;
menu "Mismo Día",-,"Domingo",-,"Lunes",-,"Martes",-,"Miercoles",-,"Jueves",-,"Friday",-,"Saturday",-;
if(@menu==1) set $eday[@num],$sday[@num];
if(@menu==2) set $eday[@num],0;
if(@menu==3) set $eday[@num],1;
if(@menu==4) set $eday[@num],2;
if(@menu==5) set $eday[@num],3;
if(@menu==6) set $eday[@num],4;
if(@menu==7) set $eday[@num],5;
if(@menu==8) set $eday[@num],6;
mes "[Configurador Horario]";
mes "Vale, ahora debes introducir la hora a la que quieres que acabe la WOE";
mes "Se usa el formato de 24 Horas";
mes "00 = Media-Noche";
mes "12 = Medio-Día";
mes "23 = 11 p.m.";
next;
input @input;
if (@input < 0 || @input > 24) goto L_BadNumber;
set $woetime2[@num],@input;
mes "[Configurador Horario]";
mes "El Horario ha sido establecido con éxito";
mes "Para ver si ha sido establecido correctamente, Quieres ver la configuración?";
menu "Sí",L_LoopList,"No",-;
close;
L_Reset:
mes "[Configurador Horario]";
mes "Estás seguro de que quieres borrar la configuración actual?";
next;
menu "No",L_No,"Sí",-;
if(agitcheck()) goto L_WoEOn;
deletearray $sday[0],200;
deletearray $eday[0],200;
deletearray $woetime[0],200;
deletearray $woetime2[0],200;
mes "[Configurador Horario]";
mes "Ha sido borrado el Horario, Quieres configurarlo)";
menu "Sí",L_AddLoopEnd,"No",-;
next;
mes "[Configurador Horario]";
mes "Recuerda configurara el horario";
close;
L_WoEOn:
mes "[Configurador Horario]";
mes "La WOE está en curso, ahora no puedes resetear el horario!!";
close;
L_No:
mes "[Configurador Horario]";
mes "Vuelve cuando quieras!";
close;
L_BadNumber:
mes "[Configurador Horario]";
mes "Has introducido un número incorrecto, prueba de nuevo";
close;
}

- script Agit_Event2 -1,{
end;
OnInit:
disablenpc "Agit_Event";
OnMinute00:
OnAgitInit:

// Chequea la hora de inicio
set $@num,0;
L_StartLoop:
if($sday[$@num] == 0 && $eday[$@num] == 0 && $woetime[$@num] == 0 && $woetime2[$@num] == 0) goto L_StartLoopEnd;
if(gettime(4)==$sday[$@num] && gettime(3)>=$woetime[$@num] && (gettime(3)<$woetime2[$@num] || $sday[$@num]!=$eday[$@num])) goto L_Start;
set $@num,$@num+1;
goto L_StartLoop;

// Chequea la hora de fin
L_StartLoopEnd:
set $@num,0;
L_EndLoop:
if($eday[$@num] == 0 && $woetime[$@num] == 0 && $woetime2[$@num] == 0) end;
if((gettime(4)==$eday[$@num]) && (gettime(3)==$woetime2[$@num])) goto L_End;
set $@num,$@num+1;
goto L_EndLoop;
end;

// Cuando Acaba WOE

L_End:
if(!agitcheck()) end;
Announce "La WOE ha acabado!",8;
AgitEnd;
end;

// Cuando Empieza la WOE
L_Start:
if(agitcheck()) end;
announce "La WOE ha comenzado en "+$ciudad+"!",8;
AgitStart;
end;

}
- script WoETest -1,{ //Parte de la WOE

OnAgitEnd:
enablenpc "payg01"; //Activa todos los warps de los castillos cuando acaba la WOE.
enablenpc "payg02";
enablenpc "payg03";
enablenpc "payg04";
enablenpc "payg05";
enablenpc "payg01-1";
enablenpc "payg02-1";
enablenpc "payg03-1";
enablenpc "payg04-1";
enablenpc "payg05-1";
enablenpc "prtg01";
enablenpc "prtg001";
enablenpc "prtg02";
enablenpc "prtg02-1";
enablenpc "prtg03-1";
enablenpc "prtg04-1";
enablenpc "prtg05-1";
enablenpc "aldg01";
enablenpc "aldg02";
enablenpc "aldg03";
enablenpc "aldg04";
enablenpc "aldg05";
enablenpc "gefg01";
enablenpc "gefg02";
enablenpc "gefg03";
enablenpc "gefg04";
enablenpc "gefg05";
enablenpc "gefg06";
enablenpc "gefg07";
enablenpc "gefg08";
enablenpc "gefg09";
enablenpc "gefg09-1";
end;

OnAgitStart:

disablenpc "payg01"; //Desactiva todos los warps de los catillos cuando la WOE comienza.
disablenpc "payg02";
disablenpc "payg03";
disablenpc "payg04";
disablenpc "payg05";
disablenpc "payg01-1";
disablenpc "payg02-1";
disablenpc "payg03-1";
disablenpc "payg04-1";
disablenpc "payg05-1";
disablenpc "prtg01";
disablenpc "prtg001";
disablenpc "prtg02";
disablenpc "prtg02-1";
disablenpc "prtg03-1";
disablenpc "prtg04-1";
disablenpc "prtg05-1";
disablenpc "aldg01";
disablenpc "aldg02";
disablenpc "aldg03";
disablenpc "aldg04";
disablenpc "aldg05";
disablenpc "gefg01";
disablenpc "gefg02";
disablenpc "gefg03";
disablenpc "gefg04";
disablenpc "gefg05";
disablenpc "gefg06";
disablenpc "gefg07";
disablenpc "gefg08";
disablenpc "gefg09";
disablenpc "gefg09-1";

switch($ciudad){ //Lee el grupo que el GM ha establecido para las Woe`s.
case 1:

enablenpc "prtg01";
enablenpc "prtg001";
enablenpc "prtg02";
enablenpc "prtg02-1";
enablenpc "prtg03-1";
enablenpc "prtg04-1";
enablenpc "prtg05-1";

case 2:

enablenpc "gefg01";
enablenpc "gefg02";
enablenpc "gefg03";
enablenpc "gefg04";
enablenpc "gefg05";
enablenpc "gefg06";
enablenpc "gefg07";
enablenpc "gefg08";
enablenpc "gefg09";
enablenpc "gefg09-1";

case 3:
enablenpc "payg01";
enablenpc "payg02";
enablenpc "payg03";
enablenpc "payg04";
enablenpc "payg05";
enablenpc "payg01-1";
enablenpc "payg02-1";
enablenpc "payg03-1";
enablenpc "payg04-1";
enablenpc "payg05-1";

case 4:

enablenpc "aldg01";
enablenpc "aldg02";
enablenpc "aldg03";
enablenpc "aldg04";
enablenpc "aldg05";

}
}
